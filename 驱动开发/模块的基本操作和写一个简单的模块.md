#### 1.模块相关的命令
- lsmod
    - 展示内核中module的状态
    - lsmod命令是cat /proc/modules文件的格式化输出

    - lsmod | grep xxx
- insmod/rmmod
    - 插入/卸载module
- modprobe xxx(推荐使用此方式完成module的插入/卸载,它可以维护依赖关系)
    - 添加module到内核(modeprobe -a)
    - 删除module(modeprobe -r)
- modinfo
    - 显示module的信息
- depmod
    - 生成modules.dep文件
    - 描述module之间的依赖关系

#### 2.编写一个简单的module文件
- (1).对应内核版本的头文件
    - 以ubuntu系统为例,安装内核版本头文件:sudo apt-get install linux-headers-$(uname -r)
    - 检查内核版本头文件是否安装成功:dpkg query -s linux-headers-$(uname -r)
    
    - 内核版本的头文件位置:/lib/modules/${uname -r}/build
- (2).编写驱动源代码及Makefile文件
```c
#include <linux/module.h>
#include <linux/kernel.h>
#include <linux/init.h>

MODULE_LICENSE("GPL");
MODULE_AUTHOR("CurryCoder");
MODULE_DESCRIPTION("hello module");
MODULE_VERSION("V1");


static int __init hello_start(void)
{
    printk(KERN_INFO "loading hello module\n");
    printk(KERN_INFO "hello world\n");
    return 0;
}

static void __exit hello_end(void) 
{
    printk(KERN_INFO "exit module");
}

// 模块加载时使用的钩子函数
module_init(hello_start);
// 模块卸载时使用的钩子函数
module_exit(hello_end);
```


```Makefile
.PHONY: all clean
obj-m=hello.o

all:
	make -C /lib/modules/${shell uname -r}/build/ M=${shell pwd} modules
clean:
	make -C /lib/modules/${shell uname -r}/build/ M=${shell pwd} clean

# -C参数表示进入到/lib/modules/${shell uname -r}/build/目录下并找到此目录下的Makefile文件
# -M参数表示构建模块的位置
```